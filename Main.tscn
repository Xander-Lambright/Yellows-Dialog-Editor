[gd_scene load_steps=2 format=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Control

var app_name = \"Rainmire Dialog Editor\"
var current_file = \"Untitled\"


func _ready():
	update_window_title()
	$MenuButtonFile.get_popup().add_item(\"New File\")
	$MenuButtonFile.get_popup().add_item(\"Open File\")
	$MenuButtonFile.get_popup().add_item(\"Save as File\")
	$MenuButtonFile.get_popup().add_item(\"Quit\")
	
	$MenuButtonFile.get_popup().connect(\"id_pressed\",self,\"_on_item_pressed\")
	
	$MenuButtonHelp.get_popup().add_item(\"About\")
	$MenuButtonHelp.get_popup().connect(\"id_pressed\",self,\"_on_item_help_pressed\")

func update_window_title():
	OS.set_window_title(app_name + ' - '+current_file)

func _on_item_pressed(id):
	var item_name = $MenuButtonFile.get_popup().get_item_text(id)
	if item_name == \"Open File\":
		$FileDialog.popup()
	elif item_name == \"Save as File\":
		$SaveFileDialog.popup()
	elif item_name == \"Quit\":
		get_tree().quit()
	elif item_name == \"New File\":
		new_file()
	print(item_name + \" pressed\")

func new_file():
	current_file = 'Untitled'
	update_window_title()
	$TextEdit.text = ''

func _on_item_help_pressed(id):
	var item_name = $MenuButtonHelp.get_popup().get_item_text(id)
	if item_name==\"About\":
		$WindowDialog.popup()

func _on_OpenFile_button_up():
	$FileDialog.popup()


func _on_SaveFile_pressed():
	$SaveFileDialog.popup()
	


func _on_FileDialog_file_selected(path):
	print(path)
	
	var f = File.new()
	f.open(path, 1)
	$TextEdit.text = f.get_as_text()
	f.close()
	current_file = path
	OS.set_window_title(app_name + ' - '+current_file)


func _on_SaveFileDialog_file_selected(path):
	var f = File.new()
	f.open(path,2)
	f.store_string($TextEdit.text)
	f.close()
	current_file = path
	OS.set_window_title(app_name + ' - '+current_file)
"

[node name="Control" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
script = SubResource( 1 )

[node name="TextEdit" type="TextEdit" parent="."]
margin_left = 265.0
margin_top = 123.0
margin_right = 792.0
margin_bottom = 458.0

[node name="FileDialog" type="FileDialog" parent="."]
margin_left = 267.0
margin_top = 80.0
margin_right = 832.0
margin_bottom = 485.0
window_title = "Open a File"
mode = 0
access = 2

[node name="SaveFileDialog" type="FileDialog" parent="."]
margin_left = 267.0
margin_top = 80.0
margin_right = 832.0
margin_bottom = 485.0
access = 2

[node name="MenuButtonFile" type="MenuButton" parent="."]
margin_left = 261.0
margin_top = 93.0
margin_right = 313.0
margin_bottom = 127.0
text = "File"

[node name="MenuButtonHelp" type="MenuButton" parent="."]
margin_left = 298.0
margin_top = 93.0
margin_right = 350.0
margin_bottom = 127.0
focus_mode = 2
text = "Help"
switch_on_hover = true

[node name="WindowDialog" type="WindowDialog" parent="."]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -183.0
margin_top = -115.0
margin_right = 183.0
margin_bottom = 115.0
window_title = "About"

[node name="Label" type="Label" parent="WindowDialog"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -125.0
margin_top = -15.5
margin_right = 125.0
margin_bottom = 15.5
text = "Rainmire Dev CustomNPC Dialog Editor
v 0.0.1"
align = 1

[connection signal="file_selected" from="FileDialog" to="." method="_on_FileDialog_file_selected"]
[connection signal="file_selected" from="SaveFileDialog" to="." method="_on_SaveFileDialog_file_selected"]
